import SEO from "../components/seo";
import { Section } from "../components/section";

<SEO title="Code Gen" />

# Code Gen

<Section id="th">Template Haskell</Section>

Template Haskell

<Section id="cli">CLI</Section>

Moprheus GraphQL also supports generating code from GraphQL
documents. To do this, you should first install
the `morpheus-graphql-code-gen` package.

the package provides cli `morpheus` with commands `build` and `check` .
The `build` command generates files from the GQL source files
contained in the `code-gen.yaml` configuration for the specified project root.
However, the `check` command only checks if the generated files match the existing GQL documents,
which is quite handy to check if the files are outdated.

Let's take a look at the following project. where we have different
posts and users and want to develop an application for client and server.

```
├── package.yaml
├── code-gen.yaml
└── src
    ├── Scalars.hs
    ├── Server
    |   └── Blog.gql
    └── Client
        ├── Blog.gql
        ├── GetPosts.gql
        └── GetUsers.gql
```

where `src/Server/Blog.gql` is defined as follows.

```graphql
scalar Markdown

type Post {
  title: String!
  body: Markdown
}

type User {
  name: String!
  posts: [Post!]!
}

type Query {
  users: [User!]!
  posts: [Post!]!
}
```

To do this, we should first configure `code-gen.yaml`.

```yaml
server:
  - name: Server API # Name of the service
    source: ./src # root folder for haskell source files
    includes:
      - Server/**/*.gql # list of gql sources
    options:
      globals: # The following module definitions are imported into the generated files
        - Scalars
client:
  - name: Client API # Name of the service
    source: ./src # root folder for haskell source files
    schema: Server/Blog.gql
    includes:
      - Client/**/*.gql # list of gql sources
    options:
      globals: # The following module definitions are imported into the generated files
        - Scalars
```

### Build

```ssh
morpheus build ./
```
