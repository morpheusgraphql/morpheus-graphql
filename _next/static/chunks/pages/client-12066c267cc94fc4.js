(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[610],{2045:function(s,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/client",function(){return n(5585)}])},4169:function(s,e,n){"use strict";var a=n(5893),c=n(9008);e.Z=function(s){var e=s.title;return(0,a.jsx)(c.default,{children:(0,a.jsxs)("title",{children:[e," | Morpheus GraphQL"]})})}},5585:function(s,e,n){"use strict";n.r(e);var a=n(5893),c=n(1151),l=n(4169);function t(s){var e=Object.assign({h2:"h2",p:"p",div:"div",pre:"pre",code:"code",span:"span"},(0,c.ah)(),s.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{title:"Morpheus GraphQL Client"}),"\n",(0,a.jsx)(e.h2,{children:"Morpheus GraphQL Client"}),"\n",(0,a.jsx)(e.p,{children:"The Morpheus GQL client enables the use of GQL queries and mutations on HTTP servers\nand also the subscription of specific topics to GQL subscriptions using websockets."}),"\n",(0,a.jsx)(e.h2,{children:"GQL Query/Mutation on HTTP server"}),"\n",(0,a.jsx)(e.p,{children:"Suppose we have the following GQL schema from which we want to retrieve information about the hero Poseidon."}),"\n",(0,a.jsx)(e.div,{className:"remark-highlight",children:(0,a.jsx)(e.pre,{className:"language-graphql",children:(0,a.jsxs)(e.code,{className:"language-graphql",children:[(0,a.jsx)(e.span,{className:"token keyword",children:"type"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"Deity"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(e.span,{className:"token attr-name",children:"name"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token scalar",children:"String"}),(0,a.jsx)(e.span,{className:"token operator",children:"!"}),"\n  ",(0,a.jsx)(e.span,{className:"token attr-name",children:"power"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token scalar",children:"String"}),"\n  ",(0,a.jsx)(e.span,{className:"token attr-name",children:"realm"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"Realm"}),(0,a.jsx)(e.span,{className:"token operator",children:"!"}),"\n  ",(0,a.jsx)(e.span,{className:"token attr-name",children:"bornAt"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"City"}),"\n",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n\n",(0,a.jsx)(e.span,{className:"token keyword",children:"enum"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"Realm"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(e.span,{className:"token property",children:"Sky"}),"\n  ",(0,a.jsx)(e.span,{className:"token property",children:"Sea"}),"\n  ",(0,a.jsx)(e.span,{className:"token property",children:"Underworld"}),"\n",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n\n",(0,a.jsx)(e.span,{className:"token keyword",children:"type"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"Query"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(e.span,{className:"token attr-name",children:"deity"}),(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token attr-name",children:"name"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token scalar",children:"String"}),(0,a.jsx)(e.span,{className:"token operator",children:"!"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(e.span,{className:"token attr-name",children:"realm"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"Realm"}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"Deity"}),(0,a.jsx)(e.span,{className:"token operator",children:"!"}),"\n",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n"]})})}),"\n",(0,a.jsxs)(e.p,{children:["we should start with ",(0,a.jsx)(e.code,{children:"declareGlobalTypes"})," to declare haskell type for ",(0,a.jsx)(e.code,{children:"Realm"})]}),"\n",(0,a.jsx)(e.div,{className:"remark-highlight",children:(0,a.jsx)(e.pre,{className:"language-hs",children:(0,a.jsxs)(e.code,{className:"language-hs",children:[(0,a.jsx)(e.span,{className:"token hvariable",children:"declareGlobalTypes"})," ",(0,a.jsx)(e.span,{className:"token string",children:'"assets/mythology.gql"'}),"\n"]})})}),"\n",(0,a.jsxs)(e.p,{children:["now we can declare haskell type for qurey ",(0,a.jsx)(e.code,{children:"GetHero"}),"."]}),"\n",(0,a.jsx)(e.div,{className:"remark-highlight",children:(0,a.jsx)(e.pre,{className:"language-hs",children:(0,a.jsxs)(e.code,{className:"language-hs",children:[(0,a.jsx)(e.span,{className:"token hvariable",children:"declareLocalTypesInline"}),"\n  ",(0,a.jsx)(e.span,{className:"token string",children:'"assets/mythology.gql"'}),"\n  ",(0,a.jsx)(e.span,{className:"token punctuation",children:"["}),(0,a.jsx)(e.span,{className:"token hvariable",children:"raw"}),(0,a.jsx)(e.span,{className:"token operator",children:"|"}),"\n    ",(0,a.jsx)(e.span,{className:"token hvariable",children:"query"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"GetHero"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token operator",children:"$"}),(0,a.jsx)(e.span,{className:"token hvariable",children:"name"}),(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"String"}),(0,a.jsx)(e.span,{className:"token operator",children:"!"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(e.span,{className:"token hvariable",children:"realm"}),(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"Sea"}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),"\n      ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n        ",(0,a.jsx)(e.span,{className:"token hvariable",children:"deity"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token hvariable",children:"name"}),(0,a.jsx)(e.span,{className:"token operator",children:":$"}),(0,a.jsx)(e.span,{className:"token hvariable",children:"name"}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n          ",(0,a.jsx)(e.span,{className:"token hvariable",children:"name"}),"\n          ",(0,a.jsx)(e.span,{className:"token hvariable",children:"power"}),"\n        ",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n      ",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n  ",(0,a.jsx)(e.span,{className:"token operator",children:"|"}),(0,a.jsx)(e.span,{className:"token punctuation",children:"]"}),"\n"]})})}),"\n",(0,a.jsx)(e.p,{children:"at the last stage can define Morpheus HTTP client with URL and custom headers which can be used to fetch Hero."}),"\n",(0,a.jsx)(e.div,{className:"remark-highlight",children:(0,a.jsx)(e.pre,{className:"language-hs",children:(0,a.jsxs)(e.code,{className:"language-hs",children:[(0,a.jsx)(e.span,{className:"token hvariable",children:"client"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"::"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"GQLClient"}),"\n",(0,a.jsx)(e.span,{className:"token hvariable",children:"client"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"="})," ",(0,a.jsx)(e.span,{className:"token string",children:'"http://localhost:3000"'})," ",(0,a.jsx)(e.span,{className:"token operator",children:"`withHeaders`"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"["}),(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token string",children:'"custom-header"'}),(0,a.jsx)(e.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(e.span,{className:"token string",children:'"custom-value"'}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),(0,a.jsx)(e.span,{className:"token punctuation",children:"]"}),"\n\n",(0,a.jsx)(e.span,{className:"token hvariable",children:"fetchHero"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"::"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"IO"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token constant",children:"ResponseStream"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"GetHero"}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),"\n",(0,a.jsx)(e.span,{className:"token hvariable",children:"fetchHero"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"="})," ",(0,a.jsx)(e.span,{className:"token hvariable",children:"request"})," ",(0,a.jsx)(e.span,{className:"token hvariable",children:"client"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"GetHeroArgs"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),(0,a.jsx)(e.span,{className:"token hvariable",children:"name"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"="})," ",(0,a.jsx)(e.span,{className:"token string",children:'"poseidon"'}),(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n"]})})}),"\n",(0,a.jsx)(e.h2,{children:"GQL Subscription with WS server"}),"\n",(0,a.jsx)(e.p,{children:"Suppose we have the following GQL schema, from which we want to subscribe information about the new users."}),"\n",(0,a.jsx)(e.div,{className:"remark-highlight",children:(0,a.jsx)(e.pre,{className:"language-graphql",children:(0,a.jsxs)(e.code,{className:"language-graphql",children:[(0,a.jsx)(e.span,{className:"token keyword",children:"type"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"User"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(e.span,{className:"token attr-name",children:"name"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token scalar",children:"String"}),(0,a.jsx)(e.span,{className:"token operator",children:"!"}),"\n  ",(0,a.jsx)(e.span,{className:"token attr-name",children:"email"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token scalar",children:"String"}),(0,a.jsx)(e.span,{className:"token operator",children:"!"}),"\n",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n\n",(0,a.jsx)(e.span,{className:"token keyword",children:"type"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"Query"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(e.span,{className:"token attr-name",children:"user"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"User"}),(0,a.jsx)(e.span,{className:"token operator",children:"!"}),"\n",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n\n",(0,a.jsx)(e.span,{className:"token keyword",children:"type"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"Subscription"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(e.span,{className:"token attr-name",children:"newUser"}),(0,a.jsx)(e.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(e.span,{className:"token class-name",children:"User"}),(0,a.jsx)(e.span,{className:"token operator",children:"!"}),"\n",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n"]})})}),"\n",(0,a.jsx)(e.p,{children:"as in the example above, we will start with the declaration of global and subscription types"}),"\n",(0,a.jsx)(e.div,{className:"remark-highlight",children:(0,a.jsx)(e.pre,{className:"language-hs",children:(0,a.jsxs)(e.code,{className:"language-hs",children:[(0,a.jsx)(e.span,{className:"token hvariable",children:"declareGlobalTypes"})," ",(0,a.jsx)(e.span,{className:"token string",children:'"assets/users.gql"'}),"\n\n",(0,a.jsx)(e.span,{className:"token hvariable",children:"declareLocalTypesInline"}),"\n  ",(0,a.jsx)(e.span,{className:"token string",children:'"assets/users.gql"'}),"\n  ",(0,a.jsx)(e.span,{className:"token punctuation",children:"["}),(0,a.jsx)(e.span,{className:"token hvariable",children:"raw"}),(0,a.jsx)(e.span,{className:"token operator",children:"|"}),"\n    ",(0,a.jsx)(e.span,{className:"token hvariable",children:"subscription"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"NewUsers"}),"\n      ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n         ",(0,a.jsx)(e.span,{className:"token hvariable",children:"newUser"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n           ",(0,a.jsx)(e.span,{className:"token hvariable",children:"name"}),"\n           ",(0,a.jsx)(e.span,{className:"token hvariable",children:"email"}),"\n        ",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n      ",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),"\n  ",(0,a.jsx)(e.span,{className:"token operator",children:"|"}),(0,a.jsx)(e.span,{className:"token punctuation",children:"]"}),"\n"]})})}),"\n",(0,a.jsxs)(e.p,{children:["as in previous example we will define client with websockets URL and use it.\nHowever, now it the results stream of ",(0,a.jsx)(e.code,{children:"NewUsers"})," instead of the single response. To print these results each time\nwe receive a new user, we can use the function ",(0,a.jsx)(e.code,{children:"forEach"}),"."]}),"\n",(0,a.jsx)(e.div,{className:"remark-highlight",children:(0,a.jsx)(e.pre,{className:"language-hs",children:(0,a.jsxs)(e.code,{className:"language-hs",children:[(0,a.jsx)(e.span,{className:"token hvariable",children:"client"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"::"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"GQLClient"}),"\n",(0,a.jsx)(e.span,{className:"token hvariable",children:"client"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"="})," ",(0,a.jsx)(e.span,{className:"token string",children:'"ws://localhost:3000"'}),"\n\n",(0,a.jsx)(e.span,{className:"token hvariable",children:"newUsers"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"::"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"IO"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token constant",children:"ResponseStream"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"NewUsers"}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),"\n",(0,a.jsx)(e.span,{className:"token hvariable",children:"newUsers"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"="})," ",(0,a.jsx)(e.span,{className:"token hvariable",children:"request"})," ",(0,a.jsx)(e.span,{className:"token hvariable",children:"client"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),"\n\n",(0,a.jsx)(e.span,{className:"token hvariable",children:"subscribeUSers"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"::"})," ",(0,a.jsx)(e.span,{className:"token constant",children:"IO"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),"\n",(0,a.jsx)(e.span,{className:"token hvariable",children:"subscribeUSers"})," ",(0,a.jsx)(e.span,{className:"token operator",children:"="})," ",(0,a.jsx)(e.span,{className:"token hvariable",children:"newUsers"})," ",(0,a.jsx)(e.span,{className:"token operator",children:">>="})," ",(0,a.jsx)(e.span,{className:"token hvariable",children:"forEach"})," ",(0,a.jsx)(e.span,{className:"token builtin",children:"print"}),"\n"]})})})]})}e.default=function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},(0,c.ah)(),s.components),n=e.wrapper;return n?(0,a.jsx)(n,Object.assign({},s,{children:(0,a.jsx)(t,s)})):t(s)}},9008:function(s,e,n){s.exports=n(3121)},1151:function(s,e,n){"use strict";n.d(e,{ah:function(){return l}});var a=n(7294);const c=a.createContext({});function l(s){const e=a.useContext(c);return a.useMemo((()=>"function"===typeof s?s(e):{...e,...s}),[e,s])}}},function(s){s.O(0,[774,888,179],(function(){return e=2045,s(s.s=e);var e}));var e=s.O();_N_E=e}]);